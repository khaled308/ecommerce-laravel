/*! SearchBuilder 1.3.1
 * Â©SpryMedia Ltd - datatables.net/license/mit
 */
(function(){'use strict';var $$2;var dataTable$2;var moment=window.moment;var luxon=window.luxon;function setJQuery$2(jq){$$2=jq;dataTable$2=jq.fn.dataTable;}
var Criteria=(function(){function Criteria(table,opts,topGroup,index,depth){var _this=this;if(index===void 0){index=0;}
if(depth===void 0){depth=1;}
if(!dataTable$2||!dataTable$2.versionCheck||!dataTable$2.versionCheck('1.10.0')){throw new Error('SearchPane requires DataTables 1.10 or newer');}
this.classes=$$2.extend(true,{},Criteria.classes);this.c=$$2.extend(true,{},Criteria.defaults,$$2.fn.dataTable.ext.searchBuilder,opts);var i18n=this.c.i18n;this.s={condition:undefined,conditions:{},data:undefined,dataIdx:-1,dataPoints:[],dateFormat:false,depth:depth,dt:table,filled:false,index:index,origData:undefined,topGroup:topGroup,type:'',value:[]};this.dom={buttons:$$2('<div/>').addClass(this.classes.buttonContainer),condition:$$2('<select disabled/>').addClass(this.classes.condition).addClass(this.classes.dropDown).addClass(this.classes.italic).attr('autocomplete','hacking'),conditionTitle:$$2('<option value="" disabled selected hidden/>').html(this.s.dt.i18n('searchBuilder.condition',i18n.condition)),container:$$2('<div/>').addClass(this.classes.container),data:$$2('<select/>').addClass(this.classes.data).addClass(this.classes.dropDown).addClass(this.classes.italic),dataTitle:$$2('<option value="" disabled selected hidden/>').html(this.s.dt.i18n('searchBuilder.data',i18n.data)),defaultValue:$$2('<select disabled/>').addClass(this.classes.value).addClass(this.classes.dropDown).addClass(this.classes.select).addClass(this.classes.italic),"delete":$$2('<button/>').html(this.s.dt.i18n('searchBuilder.delete',i18n["delete"])).addClass(this.classes["delete"]).addClass(this.classes.button).attr('title',this.s.dt.i18n('searchBuilder.deleteTitle',i18n.deleteTitle)).attr('type','button'),left:$$2('<button/>').html(this.s.dt.i18n('searchBuilder.left',i18n.left)).addClass(this.classes.left).addClass(this.classes.button).attr('title',this.s.dt.i18n('searchBuilder.leftTitle',i18n.leftTitle)).attr('type','button'),right:$$2('<button/>').html(this.s.dt.i18n('searchBuilder.right',i18n.right)).addClass(this.classes.right).addClass(this.classes.button).attr('title',this.s.dt.i18n('searchBuilder.rightTitle',i18n.rightTitle)).attr('type','button'),value:[$$2('<select disabled/>').addClass(this.classes.value).addClass(this.classes.dropDown).addClass(this.classes.italic).addClass(this.classes.select)],valueTitle:$$2('<option value="--valueTitle--" disabled selected hidden/>').html(this.s.dt.i18n('searchBuilder.value',i18n.value))};if(this.c.greyscale){this.dom.data.addClass(this.classes.greyscale);this.dom.condition.addClass(this.classes.greyscale);this.dom.defaultValue.addClass(this.classes.greyscale);for(var _i=0,_a=this.dom.value;_i<_a.length;_i++){var val=_a[_i];val.addClass(this.classes.greyscale);}}
this.s.dt.on('draw.dtsb',function(){_this._adjustCriteria();});this.s.dt.on('buttons-action.dtsb',function(){_this._adjustCriteria();});$$2(window).on('resize.dtsb',dataTable$2.util.throttle(function(){_this._adjustCriteria();}));this._buildCriteria();return this;}
Criteria._escapeHTML=function(txt){return txt.toString().replace(/&amp;/g,'&').replace(/&lt;/g,'<').replace(/&gt;/g,'>').replace(/&quot;/g,'"');};Criteria.prototype.updateArrows=function(hasSiblings,redraw){if(hasSiblings===void 0){hasSiblings=false;}
if(redraw===void 0){redraw=true;}
this.dom.container.children().detach();this.dom.container.append(this.dom.data).append(this.dom.condition).append(this.dom.value[0]);this.setListeners();if(this.dom.value[0]!==undefined){this.dom.value[0].trigger('dtsb-inserted');}
for(var i=1;i<this.dom.value.length;i++){this.dom.container.append(this.dom.value[i]);this.dom.value[i].trigger('dtsb-inserted');}
if(this.s.depth>1){this.dom.buttons.append(this.dom.left);}
if((this.c.depthLimit===false||this.s.depth<this.c.depthLimit)&&hasSiblings){this.dom.buttons.append(this.dom.right);}
else{this.dom.right.remove();}
this.dom.buttons.append(this.dom["delete"]);this.dom.container.append(this.dom.buttons);if(redraw){this._adjustCriteria();}};Criteria.prototype.destroy=function(){this.dom.data.off('.dtsb');this.dom.condition.off('.dtsb');this.dom["delete"].off('.dtsb');for(var _i=0,_a=this.dom.value;_i<_a.length;_i++){var val=_a[_i];val.off('.dtsb');}
this.dom.container.remove();};Criteria.prototype.search=function(rowData,rowIdx){var condition=this.s.conditions[this.s.condition];if(this.s.condition!==undefined&&condition!==undefined){var filter=rowData[this.s.dataIdx];if(this.s.type.includes('num')&&(this.s.dt.settings()[0].oLanguage.sDecimal!==''||this.s.dt.settings()[0].oLanguage.sThousands!=='')){var splitRD=[rowData[this.s.dataIdx]];if(this.s.dt.settings()[0].oLanguage.sDecimal!==''){splitRD=rowData[this.s.dataIdx].split(this.s.dt.settings()[0].oLanguage.sDecimal);}
if(this.s.dt.settings()[0].oLanguage.sThousands!==''){for(var i=0;i<splitRD.length;i++){splitRD[i]=splitRD[i].replace(this.s.dt.settings()[0].oLanguage.sThousands,',');}}
filter=splitRD.join('.');}
if(this.c.orthogonal.search!=='filter'){var settings=this.s.dt.settings()[0];filter=settings.oApi._fnGetCellData(settings,rowIdx,this.s.dataIdx,typeof this.c.orthogonal==='string'?this.c.orthogonal:this.c.orthogonal.search);}
if(this.s.type==='array'){if(!Array.isArray(filter)){filter=[filter];}
filter.sort();for(var _i=0,filter_1=filter;_i<filter_1.length;_i++){var filt=filter_1[_i];if(filt&&typeof filt==='string'){filt=filt.replace(/[\r\n\u2028]/g,' ');}}}
else if(filter!==null&&typeof filter==='string'){filter=filter.replace(/[\r\n\u2028]/g,' ');}
if(this.s.type.includes('html')&&typeof filter==='string'){filter=filter.replace(/(<([^>]+)>)/ig,'');}
if(filter===null){filter='';}
return condition.search(filter,this.s.value,this);}};Criteria.prototype.getDetails=function(deFormatDates){if(deFormatDates===void 0){deFormatDates=false;}
if(this.s.type!==null&&this.s.type.includes('num')&&(this.s.dt.settings()[0].oLanguage.sDecimal!==''||this.s.dt.settings()[0].oLanguage.sThousands!=='')){for(var i=0;i<this.s.value.length;i++){var splitRD=[this.s.value[i].toString()];if(this.s.dt.settings()[0].oLanguage.sDecimal!==''){splitRD=this.s.value[i].split(this.s.dt.settings()[0].oLanguage.sDecimal);}
if(this.s.dt.settings()[0].oLanguage.sThousands!==''){for(var j=0;j<splitRD.length;j++){splitRD[j]=splitRD[j].replace(this.s.dt.settings()[0].oLanguage.sThousands,',');}}
this.s.value[i]=splitRD.join('.');}}
else if(this.s.type!==null&&deFormatDates){if(this.s.type.includes('date')||this.s.type.includes('time')){for(var i=0;i<this.s.value.length;i++){if(this.s.value[i].match(/^\d{4}-([0]\d|1[0-2])-([0-2]\d|3[01])$/g)===null){this.s.value[i]='';}}}
else if(this.s.type.includes('moment')){for(var i=0;i<this.s.value.length;i++){this.s.value[i]=moment(this.s.value[i],this.s.dateFormat).toISOString();}}
else if(this.s.type.includes('luxon')){for(var i=0;i<this.s.value.length;i++){this.s.value[i]=luxon.DateTime.fromFormat(this.s.value[i],this.s.dateFormat).toISO();}}}
if(this.s.type.includes('num')&&this.s.dt.page.info().serverSide){for(var i=0;i<this.s.value.length;i++){this.s.value[i]=this.s.value[i].replace(/[^0-9.]/g,'');}}
return{condition:this.s.condition,data:this.s.data,origData:this.s.origData,type:this.s.type,value:this.s.value.map(function(a){return a.toString();})};};Criteria.prototype.getNode=function(){return this.dom.container;};Criteria.prototype.populate=function(){this._populateData();if(this.s.dataIdx!==-1){this._populateCondition();if(this.s.condition!==undefined){this._populateValue();}}};Criteria.prototype.rebuild=function(loadedCriteria){var foundData=false;var dataIdx;this._populateData();if(loadedCriteria.data!==undefined){var italic_1=this.classes.italic;var data_1=this.dom.data;this.dom.data.children('option').each(function(){if(!foundData&&($$2(this).text()===loadedCriteria.data||loadedCriteria.origData&&$$2(this).prop('origData')===loadedCriteria.origData)){$$2(this).prop('selected',true);data_1.removeClass(italic_1);foundData=true;dataIdx=$$2(this).val();}
else{$$2(this).removeProp('selected');}});}
if(foundData){this.s.data=loadedCriteria.data;this.s.origData=loadedCriteria.origData;this.s.dataIdx=dataIdx;this.c.orthogonal=this._getOptions().orthogonal;this.dom.dataTitle.remove();this._populateCondition();this.dom.conditionTitle.remove();var condition=void 0;var options=this.dom.condition.children('option');for(var i=0;i<options.length;i++){var option=$$2(options[i]);if(loadedCriteria.condition!==undefined&&option.val()===loadedCriteria.condition&&typeof loadedCriteria.condition==='string'){option.prop('selected',true);condition=option.val();}
else{option.removeProp('selected');}}
this.s.condition=condition;if(this.s.condition!==undefined){this.dom.conditionTitle.removeProp('selected');this.dom.conditionTitle.remove();this.dom.condition.removeClass(this.classes.italic);for(var i=0;i<options.length;i++){var option=$$2(options[i]);if(option.val()!==this.s.condition){option.removeProp('selected');}}
this._populateValue(loadedCriteria);}
else{this.dom.conditionTitle.prependTo(this.dom.condition).prop('selected',true);}}};Criteria.prototype.setListeners=function(){var _this=this;this.dom.data.unbind('change').on('change.dtsb',function(){_this.dom.dataTitle.removeProp('selected');var options=_this.dom.data.children('option.'+_this.classes.option);for(var i=0;i<options.length;i++){var option=$$2(options[i]);if(option.val()===_this.dom.data.val()){_this.dom.data.removeClass(_this.classes.italic);option.prop('selected',true);_this.s.dataIdx=+option.val();_this.s.data=option.text();_this.s.origData=option.prop('origData');_this.c.orthogonal=_this._getOptions().orthogonal;_this._clearCondition();_this._clearValue();_this._populateCondition();if(_this.s.filled){_this.s.filled=false;_this.s.dt.draw();_this.setListeners();}
_this.s.dt.state.save();}
else{option.removeProp('selected');}}});this.dom.condition.unbind('change').on('change.dtsb',function(){_this.dom.conditionTitle.removeProp('selected');var options=_this.dom.condition.children('option.'+_this.classes.option);for(var i=0;i<options.length;i++){var option=$$2(options[i]);if(option.val()===_this.dom.condition.val()){_this.dom.condition.removeClass(_this.classes.italic);option.prop('selected',true);var condDisp=option.val();for(var _i=0,_a=Object.keys(_this.s.conditions);_i<_a.length;_i++){var cond=_a[_i];if(cond===condDisp){_this.s.condition=condDisp;break;}}
_this._clearValue();_this._populateValue();for(var _b=0,_c=_this.dom.value;_b<_c.length;_b++){var val=_c[_b];if(_this.s.filled&&val!==undefined&&_this.dom.container.has(val[0]).length!==0){_this.s.filled=false;_this.s.dt.draw();_this.setListeners();}}
if(_this.dom.value.length===0||_this.dom.value.length===1&&_this.dom.value[0]===undefined){_this.s.dt.draw();}}
else{option.removeProp('selected');}}});};Criteria.prototype._adjustCriteria=function(){if($$2(document).has(this.dom.container).length===0){return;}
var valRight;var valWidth;var outmostval=this.dom.value[this.dom.value.length-1];if(outmostval!==undefined&&this.dom.container.has(outmostval[0]).length!==0){valWidth=outmostval.outerWidth(true);valRight=outmostval.offset().left+valWidth;}
else{return;}
var leftOffset=this.dom.left.offset();var rightOffset=this.dom.right.offset();var clearOffset=this.dom["delete"].offset();var hasLeft=this.dom.container.has(this.dom.left[0]).length!==0;var hasRight=this.dom.container.has(this.dom.right[0]).length!==0;var buttonsLeft=hasLeft?leftOffset.left:hasRight?rightOffset.left:clearOffset.left;if((buttonsLeft-valRight<15||hasLeft&&leftOffset.top!==clearOffset.top||hasRight&&rightOffset.top!==clearOffset.top)&&!this.dom.container.parent().hasClass(this.classes.vertical)){this.dom.container.parent().addClass(this.classes.vertical);this.s.topGroup.trigger('dtsb-redrawContents');}
else if(buttonsLeft-
(this.dom.data.offset().left+
this.dom.data.outerWidth(true)+
this.dom.condition.outerWidth(true)+
valWidth)>15&&this.dom.container.parent().hasClass(this.classes.vertical)){this.dom.container.parent().removeClass(this.classes.vertical);this.s.topGroup.trigger('dtsb-redrawContents');}};Criteria.prototype._buildCriteria=function(){this.dom.data.append(this.dom.dataTitle);this.dom.condition.append(this.dom.conditionTitle);this.dom.container.append(this.dom.data).append(this.dom.condition);for(var _i=0,_a=this.dom.value;_i<_a.length;_i++){var val=_a[_i];val.append(this.dom.valueTitle);this.dom.container.append(val);}
this.dom.container.append(this.dom["delete"]).append(this.dom.right);this.setListeners();};Criteria.prototype._clearCondition=function(){this.dom.condition.empty();this.dom.conditionTitle.prop('selected',true).attr('disabled','true');this.dom.condition.prepend(this.dom.conditionTitle).prop('selectedIndex',0);this.s.conditions={};this.s.condition=undefined;};Criteria.prototype._clearValue=function(){if(this.s.condition!==undefined){if(this.dom.value.length>0&&this.dom.value[0]!==undefined){var _loop_1=function(val){if(val!==undefined){setTimeout(function(){val.remove();},50);}};for(var _i=0,_a=this.dom.value;_i<_a.length;_i++){var val=_a[_i];_loop_1(val);}}
this.dom.value=[].concat(this.s.conditions[this.s.condition].init(this,Criteria.updateListener));if(this.dom.value.length>0&&this.dom.value[0]!==undefined){this.dom.value[0].insertAfter(this.dom.condition).trigger('dtsb-inserted');for(var i=1;i<this.dom.value.length;i++){this.dom.value[i].insertAfter(this.dom.value[i-1]).trigger('dtsb-inserted');}}}
else{var _loop_2=function(val){if(val!==undefined){setTimeout(function(){val.remove();},50);}};for(var _b=0,_c=this.dom.value;_b<_c.length;_b++){var val=_c[_b];_loop_2(val);}
this.dom.valueTitle.prop('selected',true);this.dom.defaultValue.append(this.dom.valueTitle).insertAfter(this.dom.condition);}
this.s.value=[];this.dom.value=[$$2('<select disabled/>').addClass(this.classes.value).addClass(this.classes.dropDown).addClass(this.classes.italic).addClass(this.classes.select).append(this.dom.valueTitle.clone())];};Criteria.prototype._getOptions=function(){var table=this.s.dt;return $$2.extend(true,{},Criteria.defaults,table.settings()[0].aoColumns[this.s.dataIdx].searchBuilder);};Criteria.prototype._populateCondition=function(){var conditionOpts=[];var conditionsLength=Object.keys(this.s.conditions).length;if(conditionsLength===0){var column=+this.dom.data.children('option:selected').val();this.s.type=this.s.dt.columns().type().toArray()[column];var colInits=this.s.dt.settings()[0].aoColumns;if(colInits!==undefined){var colInit=colInits[column];if(colInit.searchBuilderType!==undefined&&colInit.searchBuilderType!==null){this.s.type=colInit.searchBuilderType;}
else if(this.s.type===undefined||this.s.type===null){this.s.type=colInit.sType;}}
if(this.s.type===null||this.s.type===undefined){$$2.fn.dataTable.ext.oApi._fnColumnTypes(this.s.dt.settings()[0]);this.s.type=this.s.dt.columns().type().toArray()[column];}
this.dom.condition.removeAttr('disabled').empty().append(this.dom.conditionTitle).addClass(this.classes.italic);this.dom.conditionTitle.prop('selected',true);var decimal=this.s.dt.settings()[0].oLanguage.sDecimal;if(decimal!==''&&this.s.type.indexOf(decimal)===this.s.type.length-decimal.length){if(this.s.type.includes('num-fmt')){this.s.type=this.s.type.replace(decimal,'');}
else if(this.s.type.includes('num')){this.s.type=this.s.type.replace(decimal,'');}}
var conditionObj=this.c.conditions[this.s.type]!==undefined?this.c.conditions[this.s.type]:this.s.type.includes('moment')?this.c.conditions.moment:this.s.type.includes('luxon')?this.c.conditions.luxon:this.c.conditions.string;if(this.s.type.includes('moment')){this.s.dateFormat=this.s.type.replace(/moment-/g,'');}
else if(this.s.type.includes('luxon')){this.s.dateFormat=this.s.type.replace(/luxon-/g,'');}
for(var _i=0,_a=Object.keys(conditionObj);_i<_a.length;_i++){var condition=_a[_i];if(conditionObj[condition]!==null){if(this.s.dt.page.info().serverSide&&conditionObj[condition].init===Criteria.initSelect){conditionObj[condition].init=Criteria.initInput;conditionObj[condition].inputValue=Criteria.inputValueInput;conditionObj[condition].isInputValid=Criteria.isInputValidInput;}
this.s.conditions[condition]=conditionObj[condition];var condName=conditionObj[condition].conditionName;if(typeof condName==='function'){condName=condName(this.s.dt,this.c.i18n);}
conditionOpts.push($$2('<option>',{text:condName,value:condition}).addClass(this.classes.option).addClass(this.classes.notItalic));}}}
else if(conditionsLength>0){this.dom.condition.empty().removeAttr('disabled').addClass(this.classes.italic);for(var _b=0,_c=Object.keys(this.s.conditions);_b<_c.length;_b++){var condition=_c[_b];var condName=this.s.conditions[condition].conditionName;if(typeof condName==='function'){condName=condName(this.s.dt,this.c.i18n);}
var newOpt=$$2('<option>',{text:condName,value:condition}).addClass(this.classes.option).addClass(this.classes.notItalic);if(this.s.condition!==undefined&&this.s.condition===condName){newOpt.prop('selected',true);this.dom.condition.removeClass(this.classes.italic);}
conditionOpts.push(newOpt);}}
else{this.dom.condition.attr('disabled','true').addClass(this.classes.italic);return;}
for(var _d=0,conditionOpts_1=conditionOpts;_d<conditionOpts_1.length;_d++){var opt=conditionOpts_1[_d];this.dom.condition.append(opt);}
this.dom.condition.prop('selectedIndex',0);};Criteria.prototype._populateData=function(){var _this=this;this.dom.data.empty().append(this.dom.dataTitle);if(this.s.dataPoints.length===0){this.s.dt.columns().every(function(index){if(_this.c.columns===true||_this.s.dt.columns(_this.c.columns).indexes().toArray().includes(index)){var found=false;for(var _i=0,_a=_this.s.dataPoints;_i<_a.length;_i++){var val=_a[_i];if(val.index===index){found=true;break;}}
if(!found){var col=_this.s.dt.settings()[0].aoColumns[index];var opt={index:index,origData:col.data,text:(col.searchBuilderTitle===undefined?col.sTitle:col.searchBuilderTitle).replace(/(<([^>]+)>)/ig,'')};_this.s.dataPoints.push(opt);_this.dom.data.append($$2('<option>',{text:opt.text,value:opt.index}).addClass(_this.classes.option).addClass(_this.classes.notItalic).prop('origData',col.data).prop('selected',_this.s.dataIdx===opt.index?true:false));if(_this.s.dataIdx===opt.index){_this.dom.dataTitle.removeProp('selected');}}}});}
else{var _loop_3=function(data){this_1.s.dt.columns().every(function(index){var col=_this.s.dt.settings()[0].aoColumns[index];if((col.searchBuilderTitle===undefined?col.sTitle:col.searchBuilderTitle).replace(/(<([^>]+)>)/ig,'')===data.text){data.index=index;data.origData=col.data;}});var newOpt=$$2('<option>',{text:data.text.replace(/(<([^>]+)>)/ig,''),value:data.index}).addClass(this_1.classes.option).addClass(this_1.classes.notItalic).prop('origData',data.origData);if(this_1.s.data===data.text){this_1.s.dataIdx=data.index;this_1.dom.dataTitle.removeProp('selected');newOpt.prop('selected',true);this_1.dom.data.removeClass(this_1.classes.italic);}
this_1.dom.data.append(newOpt);};var this_1=this;for(var _i=0,_a=this.s.dataPoints;_i<_a.length;_i++){var data=_a[_i];_loop_3(data);}}};Criteria.prototype._populateValue=function(loadedCriteria){var _this=this;var prevFilled=this.s.filled;this.s.filled=false;setTimeout(function(){_this.dom.defaultValue.remove();},50);var _loop_4=function(val){setTimeout(function(){if(val!==undefined){val.remove();}},50);};for(var _i=0,_a=this.dom.value;_i<_a.length;_i++){var val=_a[_i];_loop_4(val);}
var children=this.dom.container.children();if(children.length>3){for(var i=2;i<children.length-1;i++){$$2(children[i]).remove();}}
if(loadedCriteria!==undefined){this.s.dt.columns().every(function(index){if(_this.s.dt.settings()[0].aoColumns[index].sTitle===loadedCriteria.data){_this.s.dataIdx=index;}});}
this.dom.value=[].concat(this.s.conditions[this.s.condition].init(this,Criteria.updateListener,loadedCriteria!==undefined?loadedCriteria.value:undefined));if(loadedCriteria!==undefined&&loadedCriteria.value!==undefined){this.s.value=loadedCriteria.value;}
if(this.dom.value[0]!==undefined){this.dom.value[0].insertAfter(this.dom.condition).trigger('dtsb-inserted');}
for(var i=1;i<this.dom.value.length;i++){this.dom.value[i].insertAfter(this.dom.value[i-1]).trigger('dtsb-inserted');}
this.s.filled=this.s.conditions[this.s.condition].isInputValid(this.dom.value,this);this.setListeners();if(prevFilled!==this.s.filled){if(!this.s.dt.page.info().serverSide){this.s.dt.draw();}
this.setListeners();}};Criteria.prototype._throttle=function(fn,frequency){if(frequency===void 0){frequency=200;}
var last=null;var timer=null;var that=this;if(frequency===null){frequency=200;}
return function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i];}
var now=+new Date();if(last!==null&&now<last+frequency){clearTimeout(timer);}
else{last=now;}
timer=setTimeout(function(){last=null;fn.apply(that,args);},frequency);};};Criteria.version='1.1.0';Criteria.classes={button:'dtsb-button',buttonContainer:'dtsb-buttonContainer',condition:'dtsb-condition',container:'dtsb-criteria',data:'dtsb-data',"delete":'dtsb-delete',dropDown:'dtsb-dropDown',greyscale:'dtsb-greyscale',input:'dtsb-input',italic:'dtsb-italic',joiner:'dtsp-joiner',left:'dtsb-left',notItalic:'dtsb-notItalic',option:'dtsb-option',right:'dtsb-right',select:'dtsb-select',value:'dtsb-value',vertical:'dtsb-vertical'};Criteria.initSelect=function(that,fn,preDefined,array){if(preDefined===void 0){preDefined=null;}
if(array===void 0){array=false;}
var column=that.dom.data.children('option:selected').val();var indexArray=that.s.dt.rows().indexes().toArray();var settings=that.s.dt.settings()[0];that.dom.valueTitle.prop('selected',true);var el=$$2('<select/>').addClass(Criteria.classes.value).addClass(Criteria.classes.dropDown).addClass(Criteria.classes.italic).addClass(Criteria.classes.select).append(that.dom.valueTitle).on('change.dtsb',function(){$$2(this).removeClass(Criteria.classes.italic);fn(that,this);});if(that.c.greyscale){el.addClass(Criteria.classes.greyscale);}
var added=[];var options=[];for(var _i=0,indexArray_1=indexArray;_i<indexArray_1.length;_i++){var index=indexArray_1[_i];var filter=settings.oApi._fnGetCellData(settings,index,column,typeof that.c.orthogonal==='string'?that.c.orthogonal:that.c.orthogonal.search);var value={filter:typeof filter==='string'?filter.replace(/[\r\n\u2028]/g,' '):filter,index:index,text:settings.oApi._fnGetCellData(settings,index,column,typeof that.c.orthogonal==='string'?that.c.orthogonal:that.c.orthogonal.display)};if(that.s.type==='array'){value.filter=!Array.isArray(value.filter)?[value.filter]:value.filter;value.text=!Array.isArray(value.text)?[value.text]:value.text;}
var addOption=function(filt,text){if(that.s.type.includes('html')&&filt!==null&&typeof filt==='string'){filt.replace(/(<([^>]+)>)/ig,'');}
var opt=$$2('<option>',{type:Array.isArray(filt)?'Array':'String',value:filt}).data('sbv',filt).addClass(that.classes.option).addClass(that.classes.notItalic)
.html(typeof text==='string'?text.replace(/(<([^>]+)>)/ig,''):text);var val=opt.val();if(added.indexOf(val)===-1){added.push(val);options.push(opt);if(preDefined!==null&&Array.isArray(preDefined[0])){preDefined[0]=preDefined[0].sort().join(',');}
if(preDefined!==null&&opt.val()===preDefined[0]){opt.prop('selected',true);el.removeClass(Criteria.classes.italic);that.dom.valueTitle.removeProp('selected');}}};if(array){for(var i=0;i<value.filter.length;i++){addOption(value.filter[i],value.text[i]);}}
else{addOption(value.filter,Array.isArray(value.text)?value.text.join(', '):value.text);}}
options.sort(function(a,b){if(that.s.type==='array'||that.s.type==='string'||that.s.type==='html'){if(a.val()<b.val()){return-1;}
else if(a.val()>b.val()){return 1;}
else{return 0;}}
else if(that.s.type==='num'||that.s.type==='html-num'){if(+a.val().replace(/(<([^>]+)>)/ig,'')<+b.val().replace(/(<([^>]+)>)/ig,'')){return-1;}
else if(+a.val().replace(/(<([^>]+)>)/ig,'')>+b.val().replace(/(<([^>]+)>)/ig,'')){return 1;}
else{return 0;}}
else if(that.s.type==='num-fmt'||that.s.type==='html-num-fmt'){if(+a.val().replace(/[^0-9.]/g,'')<+b.val().replace(/[^0-9.]/g,'')){return-1;}
else if(+a.val().replace(/[^0-9.]/g,'')>+b.val().replace(/[^0-9.]/g,'')){return 1;}
else{return 0;}}});for(var _a=0,options_1=options;_a<options_1.length;_a++){var opt=options_1[_a];el.append(opt);}
return el;};Criteria.initSelectArray=function(that,fn,preDefined){if(preDefined===void 0){preDefined=null;}
return Criteria.initSelect(that,fn,preDefined,true);};Criteria.initInput=function(that,fn,preDefined){if(preDefined===void 0){preDefined=null;}
var searchDelay=that.s.dt.settings()[0].searchDelay;var el=$$2('<input/>').addClass(Criteria.classes.value).addClass(Criteria.classes.input).on('input.dtsb keypress.dtsb',that._throttle(function(e){var code=e.keyCode||e.which;if(!that.c.enterSearch&&!(that.s.dt.settings()[0].oInit.search!==undefined&&that.s.dt.settings()[0].oInit.search["return"])||code===13){return fn(that,this);}},searchDelay===null?100:searchDelay));if(that.c.greyscale){el.addClass(Criteria.classes.greyscale);}
if(preDefined!==null){el.val(preDefined[0]);}
that.s.dt.one('draw.dtsb',function(){that.s.topGroup.trigger('dtsb-redrawLogic');});return el;};Criteria.init2Input=function(that,fn,preDefined){if(preDefined===void 0){preDefined=null;}
var searchDelay=that.s.dt.settings()[0].searchDelay;var els=[$$2('<input/>').addClass(Criteria.classes.value).addClass(Criteria.classes.input).on('input.dtsb keypress.dtsb',that._throttle(function(e){var code=e.keyCode||e.which;if(!that.c.enterSearch&&!(that.s.dt.settings()[0].oInit.search!==undefined&&that.s.dt.settings()[0].oInit.search["return"])||code===13){return fn(that,this);}},searchDelay===null?100:searchDelay)),$$2('<span>').addClass(that.classes.joiner).html(that.s.dt.i18n('searchBuilder.valueJoiner',that.c.i18n.valueJoiner)),$$2('<input/>').addClass(Criteria.classes.value).addClass(Criteria.classes.input).on('input.dtsb keypress.dtsb',that._throttle(function(e){var code=e.keyCode||e.which;if(!that.c.enterSearch&&!(that.s.dt.settings()[0].oInit.search!==undefined&&that.s.dt.settings()[0].oInit.search["return"])||code===13){return fn(that,this);}},searchDelay===null?100:searchDelay))];if(that.c.greyscale){els[0].addClass(Criteria.classes.greyscale);els[2].addClass(Criteria.classes.greyscale);}
if(preDefined!==null){els[0].val(preDefined[0]);els[2].val(preDefined[1]);}
that.s.dt.one('draw.dtsb',function(){that.s.topGroup.trigger('dtsb-redrawLogic');});return els;};Criteria.initDate=function(that,fn,preDefined){if(preDefined===void 0){preDefined=null;}
var searchDelay=that.s.dt.settings()[0].searchDelay;var el=$$2('<input/>').addClass(Criteria.classes.value).addClass(Criteria.classes.input).dtDateTime({attachTo:'input',format:that.s.dateFormat?that.s.dateFormat:undefined}).on('change.dtsb',that._throttle(function(){return fn(that,this);},searchDelay===null?100:searchDelay)).on('input.dtsb keypress.dtsb',that.c.enterSearch||that.s.dt.settings()[0].oInit.search!==undefined&&that.s.dt.settings()[0].oInit.search["return"]?function(e){that._throttle(function(){var code=e.keyCode||e.which;if(code===13){return fn(that,this);}},searchDelay===null?100:searchDelay);}:that._throttle(function(){return fn(that,this);},searchDelay===null?100:searchDelay));if(that.c.greyscale){el.addClass(Criteria.classes.greyscale);}
if(preDefined!==null){el.val(preDefined[0]);}
that.s.dt.one('draw.dtsb',function(){that.s.topGroup.trigger('dtsb-redrawLogic');});return el;};Criteria.initNoValue=function(that){that.s.dt.one('draw.dtsb',function(){that.s.topGroup.trigger('dtsb-redrawLogic');});};Criteria.init2Date=function(that,fn,preDefined){var _this=this;if(preDefined===void 0){preDefined=null;}
var searchDelay=that.s.dt.settings()[0].searchDelay;var els=[$$2('<input/>').addClass(Criteria.classes.value).addClass(Criteria.classes.input).dtDateTime({attachTo:'input',format:that.s.dateFormat?that.s.dateFormat:undefined}).on('change.dtsb',searchDelay!==null?that.s.dt.settings()[0].oApi._fnThrottle(function(){return fn(that,this);},searchDelay):function(){fn(that,_this);}).on('input.dtsb keypress.dtsb',!that.c.enterSearch&&!(that.s.dt.settings()[0].oInit.search!==undefined&&that.s.dt.settings()[0].oInit.search["return"])&&searchDelay!==null?that.s.dt.settings()[0].oApi._fnThrottle(function(){return fn(that,this);},searchDelay):that.c.enterSearch||that.s.dt.settings()[0].oInit.search!==undefined&&that.s.dt.settings()[0].oInit.search["return"]?function(e){var code=e.keyCode||e.which;if(code===13){fn(that,_this);}}:function(){fn(that,_this);}),$$2('<span>').addClass(that.classes.joiner).html(that.s.dt.i18n('searchBuilder.valueJoiner',that.c.i18n.valueJoiner)),$$2('<input/>').addClass(Criteria.classes.value).addClass(Criteria.classes.input).dtDateTime({attachTo:'input',format:that.s.dateFormat?that.s.dateFormat:undefined}).on('change.dtsb',searchDelay!==null?that.s.dt.settings()[0].oApi._fnThrottle(function(){return fn(that,this);},searchDelay):function(){fn(that,_this);}).on('input.dtsb keypress.dtsb',!that.c.enterSearch&&!(that.s.dt.settings()[0].oInit.search!==undefined&&that.s.dt.settings()[0].oInit.search["return"])&&searchDelay!==null?that.s.dt.settings()[0].oApi._fnThrottle(function(){return fn(that,this);},searchDelay):that.c.enterSearch||that.s.dt.settings()[0].oInit.search!==undefined&&that.s.dt.settings()[0].oInit.search["return"]?function(e){var code=e.keyCode||e.which;if(code===13){fn(that,_this);}}:function(){fn(that,_this);})];if(that.c.greyscale){els[0].addClass(Criteria.classes.greyscale);els[2].addClass(Criteria.classes.greyscale);}
if(preDefined!==null&&preDefined.length>0){els[0].val(preDefined[0]);els[2].val(preDefined[1]);}
that.s.dt.one('draw.dtsb',function(){that.s.topGroup.trigger('dtsb-redrawLogic');});return els;};Criteria.isInputValidSelect=function(el){var allFilled=true;for(var _i=0,el_1=el;_i<el_1.length;_i++){var element=el_1[_i];if(element.children('option:selected').length===element.children('option').length-
element.children('option.'+Criteria.classes.notItalic).length&&element.children('option:selected').length===1&&element.children('option:selected')[0]===element.children('option')[0]){allFilled=false;}}
return allFilled;};Criteria.isInputValidInput=function(el){var allFilled=true;for(var _i=0,el_2=el;_i<el_2.length;_i++){var element=el_2[_i];if(element.is('input')&&element.val().length===0){allFilled=false;}}
return allFilled;};Criteria.inputValueSelect=function(el){var values=[];for(var _i=0,el_3=el;_i<el_3.length;_i++){var element=el_3[_i];if(element.is('select')){values.push(Criteria._escapeHTML(element.children('option:selected').data('sbv')));}}
return values;};Criteria.inputValueInput=function(el){var values=[];for(var _i=0,el_4=el;_i<el_4.length;_i++){var element=el_4[_i];if(element.is('input')){values.push(Criteria._escapeHTML(element.val()));}}
return values;};Criteria.updateListener=function(that,el){var condition=that.s.conditions[that.s.condition];that.s.filled=condition.isInputValid(that.dom.value,that);that.s.value=condition.inputValue(that.dom.value,that);if(!that.s.filled){that.s.dt.draw();return;}
if(!Array.isArray(that.s.value)){that.s.value=[that.s.value];}
for(var i=0;i<that.s.value.length;i++){if(Array.isArray(that.s.value[i])){that.s.value[i].sort();}
else if(that.s.type.includes('num')&&(that.s.dt.settings()[0].oLanguage.sDecimal!==''||that.s.dt.settings()[0].oLanguage.sThousands!=='')){var splitRD=[that.s.value[i].toString()];if(that.s.dt.settings()[0].oLanguage.sDecimal!==''){splitRD=that.s.value[i].split(that.s.dt.settings()[0].oLanguage.sDecimal);}
if(that.s.dt.settings()[0].oLanguage.sThousands!==''){for(var j=0;j<splitRD.length;j++){splitRD[j]=splitRD[j].replace(that.s.dt.settings()[0].oLanguage.sThousands,',');}}
that.s.value[i]=splitRD.join('.');}}
var idx=null;var cursorPos=null;for(var i=0;i<that.dom.value.length;i++){if(el===that.dom.value[i][0]){idx=i;if(el.selectionStart!==undefined){cursorPos=el.selectionStart;}}}
that.s.dt.draw();if(idx!==null){that.dom.value[idx].removeClass(that.classes.italic);that.dom.value[idx].focus();if(cursorPos!==null){that.dom.value[idx][0].setSelectionRange(cursorPos,cursorPos);}}};Criteria.dateConditions={'=':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.date.equals',i18n.conditions.date.equals);},init:Criteria.initDate,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){value=value.replace(/(\/|-|,)/g,'-');return value===comparison[0];}},'!=':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.date.not',i18n.conditions.date.not);},init:Criteria.initDate,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){value=value.replace(/(\/|-|,)/g,'-');return value!==comparison[0];}},'<':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.date.before',i18n.conditions.date.before);},init:Criteria.initDate,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){value=value.replace(/(\/|-|,)/g,'-');return value<comparison[0];}},'>':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.date.after',i18n.conditions.date.after);},init:Criteria.initDate,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){value=value.replace(/(\/|-|,)/g,'-');return value>comparison[0];}},'between':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.date.between',i18n.conditions.date.between);},init:Criteria.init2Date,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){value=value.replace(/(\/|-|,)/g,'-');if(comparison[0]<comparison[1]){return comparison[0]<=value&&value<=comparison[1];}
else{return comparison[1]<=value&&value<=comparison[0];}}},'!between':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.date.notBetween',i18n.conditions.date.notBetween);},init:Criteria.init2Date,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){value=value.replace(/(\/|-|,)/g,'-');if(comparison[0]<comparison[1]){return!(comparison[0]<=value&&value<=comparison[1]);}
else{return!(comparison[1]<=value&&value<=comparison[0]);}}},'null':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.date.empty',i18n.conditions.date.empty);},init:Criteria.initNoValue,inputValue:function(){return;},isInputValid:function(){return true;},search:function(value){return value===null||value===undefined||value.length===0;}},'!null':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.date.notEmpty',i18n.conditions.date.notEmpty);},init:Criteria.initNoValue,inputValue:function(){return;},isInputValid:function(){return true;},search:function(value){return!(value===null||value===undefined||value.length===0);}}};Criteria.momentDateConditions={'=':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.date.equals',i18n.conditions.date.equals);},init:Criteria.initDate,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison,that){return moment(value,that.s.dateFormat).valueOf()===moment(comparison[0],that.s.dateFormat).valueOf();}},'!=':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.date.not',i18n.conditions.date.not);},init:Criteria.initDate,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison,that){return moment(value,that.s.dateFormat).valueOf()!==moment(comparison[0],that.s.dateFormat).valueOf();}},'<':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.date.before',i18n.conditions.date.before);},init:Criteria.initDate,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison,that){return moment(value,that.s.dateFormat).valueOf()<moment(comparison[0],that.s.dateFormat).valueOf();}},'>':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.date.after',i18n.conditions.date.after);},init:Criteria.initDate,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison,that){return moment(value,that.s.dateFormat).valueOf()>moment(comparison[0],that.s.dateFormat).valueOf();}},'between':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.date.between',i18n.conditions.date.between);},init:Criteria.init2Date,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison,that){var val=moment(value,that.s.dateFormat).valueOf();var comp0=moment(comparison[0],that.s.dateFormat).valueOf();var comp1=moment(comparison[1],that.s.dateFormat).valueOf();if(comp0<comp1){return comp0<=val&&val<=comp1;}
else{return comp1<=val&&val<=comp0;}}},'!between':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.date.notBetween',i18n.conditions.date.notBetween);},init:Criteria.init2Date,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison,that){var val=moment(value,that.s.dateFormat).valueOf();var comp0=moment(comparison[0],that.s.dateFormat).valueOf();var comp1=moment(comparison[1],that.s.dateFormat).valueOf();if(comp0<comp1){return!(+comp0<=+val&&+val<=+comp1);}
else{return!(+comp1<=+val&&+val<=+comp0);}}},'null':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.date.empty',i18n.conditions.date.empty);},init:Criteria.initNoValue,inputValue:function(){return;},isInputValid:function(){return true;},search:function(value){return value===null||value===undefined||value.length===0;}},'!null':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.date.notEmpty',i18n.conditions.date.notEmpty);},init:Criteria.initNoValue,inputValue:function(){return;},isInputValid:function(){return true;},search:function(value){return!(value===null||value===undefined||value.length===0);}}};Criteria.luxonDateConditions={'=':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.date.equals',i18n.conditions.date.equals);},init:Criteria.initDate,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison,that){return luxon.DateTime.fromFormat(value,that.s.dateFormat).ts===luxon.DateTime.fromFormat(comparison[0],that.s.dateFormat).ts;}},'!=':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.date.not',i18n.conditions.date.not);},init:Criteria.initDate,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison,that){return luxon.DateTime.fromFormat(value,that.s.dateFormat).ts!==luxon.DateTime.fromFormat(comparison[0],that.s.dateFormat).ts;}},'<':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.date.before',i18n.conditions.date.before);},init:Criteria.initDate,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison,that){return luxon.DateTime.fromFormat(value,that.s.dateFormat).ts<luxon.DateTime.fromFormat(comparison[0],that.s.dateFormat).ts;}},'>':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.date.after',i18n.conditions.date.after);},init:Criteria.initDate,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison,that){return luxon.DateTime.fromFormat(value,that.s.dateFormat).ts>luxon.DateTime.fromFormat(comparison[0],that.s.dateFormat).ts;}},'between':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.date.between',i18n.conditions.date.between);},init:Criteria.init2Date,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison,that){var val=luxon.DateTime.fromFormat(value,that.s.dateFormat).ts;var comp0=luxon.DateTime.fromFormat(comparison[0],that.s.dateFormat).ts;var comp1=luxon.DateTime.fromFormat(comparison[1],that.s.dateFormat).ts;if(comp0<comp1){return comp0<=val&&val<=comp1;}
else{return comp1<=val&&val<=comp0;}}},'!between':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.date.notBetween',i18n.conditions.date.notBetween);},init:Criteria.init2Date,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison,that){var val=luxon.DateTime.fromFormat(value,that.s.dateFormat).ts;var comp0=luxon.DateTime.fromFormat(comparison[0],that.s.dateFormat).ts;var comp1=luxon.DateTime.fromFormat(comparison[1],that.s.dateFormat).ts;if(comp0<comp1){return!(+comp0<=+val&&+val<=+comp1);}
else{return!(+comp1<=+val&&+val<=+comp0);}}},'null':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.date.empty',i18n.conditions.date.empty);},init:Criteria.initNoValue,inputValue:function(){return;},isInputValid:function(){return true;},search:function(value){return value===null||value===undefined||value.length===0;}},'!null':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.date.notEmpty',i18n.conditions.date.notEmpty);},init:Criteria.initNoValue,inputValue:function(){return;},isInputValid:function(){return true;},search:function(value){return!(value===null||value===undefined||value.length===0);}}};Criteria.numConditions={'=':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.number.equals',i18n.conditions.number.equals);},init:Criteria.initSelect,inputValue:Criteria.inputValueSelect,isInputValid:Criteria.isInputValidSelect,search:function(value,comparison){return+value===+comparison[0];}},'!=':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.number.not',i18n.conditions.number.not);},init:Criteria.initSelect,inputValue:Criteria.inputValueSelect,isInputValid:Criteria.isInputValidSelect,search:function(value,comparison){return+value!==+comparison[0];}},'<':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.number.lt',i18n.conditions.number.lt);},init:Criteria.initInput,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){return+value<+comparison[0];}},'<=':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.number.lte',i18n.conditions.number.lte);},init:Criteria.initInput,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){return+value<=+comparison[0];}},'>=':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.number.gte',i18n.conditions.number.gte);},init:Criteria.initInput,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){return+value>=+comparison[0];}},'>':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.number.gt',i18n.conditions.number.gt);},init:Criteria.initInput,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){return+value>+comparison[0];}},'between':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.number.between',i18n.conditions.number.between);},init:Criteria.init2Input,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){if(+comparison[0]<+comparison[1]){return+comparison[0]<=+value&&+value<=+comparison[1];}
else{return+comparison[1]<=+value&&+value<=+comparison[0];}}},'!between':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.number.notBetween',i18n.conditions.number.notBetween);},init:Criteria.init2Input,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){if(+comparison[0]<+comparison[1]){return!(+comparison[0]<=+value&&+value<=+comparison[1]);}
else{return!(+comparison[1]<=+value&&+value<=+comparison[0]);}}},'null':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.number.empty',i18n.conditions.number.empty);},init:Criteria.initNoValue,inputValue:function(){return;},isInputValid:function(){return true;},search:function(value){return value===null||value===undefined||value.length===0;}},'!null':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.number.notEmpty',i18n.conditions.number.notEmpty);},init:Criteria.initNoValue,inputValue:function(){return;},isInputValid:function(){return true;},search:function(value){return!(value===null||value===undefined||value.length===0);}}};Criteria.numFmtConditions={'=':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.number.equals',i18n.conditions.number.equals);},init:Criteria.initSelect,inputValue:Criteria.inputValueSelect,isInputValid:Criteria.isInputValidSelect,search:function(value,comparison){var val=value.indexOf('-')===0?'-'+value.replace(/[^0-9.]/g,''):value.replace(/[^0-9.]/g,'');var comp=comparison[0].indexOf('-')===0?'-'+comparison[0].replace(/[^0-9.]/g,''):comparison[0].replace(/[^0-9.]/g,'');return+val===+comp;}},'!=':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.number.not',i18n.conditions.number.not);},init:Criteria.initSelect,inputValue:Criteria.inputValueSelect,isInputValid:Criteria.isInputValidSelect,search:function(value,comparison){var val=value.indexOf('-')===0?'-'+value.replace(/[^0-9.]/g,''):value.replace(/[^0-9.]/g,'');var comp=comparison[0].indexOf('-')===0?'-'+comparison[0].replace(/[^0-9.]/g,''):comparison[0].replace(/[^0-9.]/g,'');return+val!==+comp;}},'<':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.number.lt',i18n.conditions.number.lt);},init:Criteria.initInput,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){var val=value.indexOf('-')===0?'-'+value.replace(/[^0-9.]/g,''):value.replace(/[^0-9.]/g,'');var comp=comparison[0].indexOf('-')===0?'-'+comparison[0].replace(/[^0-9.]/g,''):comparison[0].replace(/[^0-9.]/g,'');return+val<+comp;}},'<=':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.number.lte',i18n.conditions.number.lte);},init:Criteria.initInput,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){var val=value.indexOf('-')===0?'-'+value.replace(/[^0-9.]/g,''):value.replace(/[^0-9.]/g,'');var comp=comparison[0].indexOf('-')===0?'-'+comparison[0].replace(/[^0-9.]/g,''):comparison[0].replace(/[^0-9.]/g,'');return+val<=+comp;}},'>=':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.number.gte',i18n.conditions.number.gte);},init:Criteria.initInput,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){var val=value.indexOf('-')===0?'-'+value.replace(/[^0-9.]/g,''):value.replace(/[^0-9.]/g,'');var comp=comparison[0].indexOf('-')===0?'-'+comparison[0].replace(/[^0-9.]/g,''):comparison[0].replace(/[^0-9.]/g,'');return+val>=+comp;}},'>':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.number.gt',i18n.conditions.number.gt);},init:Criteria.initInput,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){var val=value.indexOf('-')===0?'-'+value.replace(/[^0-9.]/g,''):value.replace(/[^0-9.]/g,'');var comp=comparison[0].indexOf('-')===0?'-'+comparison[0].replace(/[^0-9.]/g,''):comparison[0].replace(/[^0-9.]/g,'');return+val>+comp;}},'between':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.number.between',i18n.conditions.number.between);},init:Criteria.init2Input,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){var val=value.indexOf('-')===0?'-'+value.replace(/[^0-9.]/g,''):value.replace(/[^0-9.]/g,'');var comp0=comparison[0].indexOf('-')===0?'-'+comparison[0].replace(/[^0-9.]/g,''):comparison[0].replace(/[^0-9.]/g,'');var comp1=comparison[1].indexOf('-')===0?'-'+comparison[1].replace(/[^0-9.]/g,''):comparison[1].replace(/[^0-9.]/g,'');if(+comp0<+comp1){return+comp0<=+val&&+val<=+comp1;}
else{return+comp1<=+val&&+val<=+comp0;}}},'!between':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.number.notBetween',i18n.conditions.number.notBetween);},init:Criteria.init2Input,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){var val=value.indexOf('-')===0?'-'+value.replace(/[^0-9.]/g,''):value.replace(/[^0-9.]/g,'');var comp0=comparison[0].indexOf('-')===0?'-'+comparison[0].replace(/[^0-9.]/g,''):comparison[0].replace(/[^0-9.]/g,'');var comp1=comparison[1].indexOf('-')===0?'-'+comparison[1].replace(/[^0-9.]/g,''):comparison[1].replace(/[^0-9.]/g,'');if(+comp0<+comp1){return!(+comp0<=+val&&+val<=+comp1);}
else{return!(+comp1<=+val&&+val<=+comp0);}}},'null':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.number.empty',i18n.conditions.number.empty);},init:Criteria.initNoValue,inputValue:function(){return;},isInputValid:function(){return true;},search:function(value){return value===null||value===undefined||value.length===0;}},'!null':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.number.notEmpty',i18n.conditions.number.notEmpty);},init:Criteria.initNoValue,inputValue:function(){return;},isInputValid:function(){return true;},search:function(value){return!(value===null||value===undefined||value.length===0);}}};Criteria.stringConditions={'=':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.string.equals',i18n.conditions.string.equals);},init:Criteria.initSelect,inputValue:Criteria.inputValueSelect,isInputValid:Criteria.isInputValidSelect,search:function(value,comparison){return value===comparison[0];}},'!=':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.string.not',i18n.conditions.string.not);},init:Criteria.initSelect,inputValue:Criteria.inputValueSelect,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){return value!==comparison[0];}},'starts':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.string.startsWith',i18n.conditions.string.startsWith);},init:Criteria.initInput,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){return value.toLowerCase().indexOf(comparison[0].toLowerCase())===0;}},'!starts':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.string.notStartsWith',i18n.conditions.string.notStartsWith);},init:Criteria.initInput,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){return value.toLowerCase().indexOf(comparison[0].toLowerCase())!==0;}},'contains':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.string.contains',i18n.conditions.string.contains);},init:Criteria.initInput,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){return value.toLowerCase().includes(comparison[0].toLowerCase());}},'!contains':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.string.notContains',i18n.conditions.string.notContains);},init:Criteria.initInput,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){return!value.toLowerCase().includes(comparison[0].toLowerCase());}},'ends':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.string.endsWith',i18n.conditions.string.endsWith);},init:Criteria.initInput,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){return value.toLowerCase().endsWith(comparison[0].toLowerCase());}},'!ends':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.string.notEndsWith',i18n.conditions.string.notEndsWith);},init:Criteria.initInput,inputValue:Criteria.inputValueInput,isInputValid:Criteria.isInputValidInput,search:function(value,comparison){return!value.toLowerCase().endsWith(comparison[0].toLowerCase());}},'null':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.string.empty',i18n.conditions.string.empty);},init:Criteria.initNoValue,inputValue:function(){return;},isInputValid:function(){return true;},search:function(value){return value===null||value===undefined||value.length===0;}},'!null':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.string.notEmpty',i18n.conditions.string.notEmpty);},init:Criteria.initNoValue,inputValue:function(){return;},isInputValid:function(){return true;},search:function(value){return!(value===null||value===undefined||value.length===0);}}};Criteria.arrayConditions={'contains':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.array.contains',i18n.conditions.array.contains);},init:Criteria.initSelectArray,inputValue:Criteria.inputValueSelect,isInputValid:Criteria.isInputValidSelect,search:function(value,comparison){return value.includes(comparison[0]);}},'without':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.array.without',i18n.conditions.array.without);},init:Criteria.initSelectArray,inputValue:Criteria.inputValueSelect,isInputValid:Criteria.isInputValidSelect,search:function(value,comparison){return value.indexOf(comparison[0])===-1;}},'=':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.array.equals',i18n.conditions.array.equals);},init:Criteria.initSelect,inputValue:Criteria.inputValueSelect,isInputValid:Criteria.isInputValidSelect,search:function(value,comparison){if(value.length===comparison[0].length){for(var i=0;i<value.length;i++){if(value[i]!==comparison[0][i]){return false;}}
return true;}
return false;}},'!=':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.array.not',i18n.conditions.array.not);},init:Criteria.initSelect,inputValue:Criteria.inputValueSelect,isInputValid:Criteria.isInputValidSelect,search:function(value,comparison){if(value.length===comparison[0].length){for(var i=0;i<value.length;i++){if(value[i]!==comparison[0][i]){return true;}}
return false;}
return true;}},'null':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.array.empty',i18n.conditions.array.empty);},init:Criteria.initNoValue,inputValue:function(){return;},isInputValid:function(){return true;},search:function(value){return value===null||value===undefined||value.length===0;}},'!null':{conditionName:function(dt,i18n){return dt.i18n('searchBuilder.conditions.array.notEmpty',i18n.conditions.array.notEmpty);},init:Criteria.initNoValue,inputValue:function(){return;},isInputValid:function(){return true;},search:function(value){return value!==null&&value!==undefined&&value.length!==0;}}};Criteria.defaults={columns:true,conditions:{'array':Criteria.arrayConditions,'date':Criteria.dateConditions,'html':Criteria.stringConditions,'html-num':Criteria.numConditions,'html-num-fmt':Criteria.numFmtConditions,'luxon':Criteria.luxonDateConditions,'moment':Criteria.momentDateConditions,'num':Criteria.numConditions,'num-fmt':Criteria.numFmtConditions,'string':Criteria.stringConditions},depthLimit:false,enterSearch:false,filterChanged:undefined,greyscale:false,i18n:{add:'Add Condition',button:{0:'Search Builder',_:'Search Builder (%d)'},clearAll:'Clear All',condition:'Condition',data:'Data',"delete":'&times',deleteTitle:'Delete filtering rule',left:'<',leftTitle:'Outdent criteria',logicAnd:'And',logicOr:'Or',right:'>',rightTitle:'Indent criteria',title:{0:'Custom Search Builder',_:'Custom Search Builder (%d)'},value:'Value',valueJoiner:'and'},logic:'AND',orthogonal:{display:'display',search:'filter'},preDefined:false};return Criteria;}());var $$1;var dataTable$1;function setJQuery$1(jq){$$1=jq;dataTable$1=jq.fn.dataTable;}
var Group=(function(){function Group(table,opts,topGroup,index,isChild,depth){if(index===void 0){index=0;}
if(isChild===void 0){isChild=false;}
if(depth===void 0){depth=1;}
if(!dataTable$1||!dataTable$1.versionCheck||!dataTable$1.versionCheck('1.10.0')){throw new Error('SearchBuilder requires DataTables 1.10 or newer');}
this.classes=$$1.extend(true,{},Group.classes);this.c=$$1.extend(true,{},Group.defaults,opts);this.s={criteria:[],depth:depth,dt:table,index:index,isChild:isChild,logic:undefined,opts:opts,preventRedraw:false,toDrop:undefined,topGroup:topGroup};this.dom={add:$$1('<button/>').addClass(this.classes.add).addClass(this.classes.button).attr('type','button'),clear:$$1('<button>&times</button>').addClass(this.classes.button).addClass(this.classes.clearGroup).attr('type','button'),container:$$1('<div/>').addClass(this.classes.group),logic:$$1('<button><div/></button>').addClass(this.classes.logic).addClass(this.classes.button).attr('type','button'),logicContainer:$$1('<div/>').addClass(this.classes.logicContainer)};if(this.s.topGroup===undefined){this.s.topGroup=this.dom.container;}
this._setup();return this;}
Group.prototype.destroy=function(){this.dom.add.off('.dtsb');this.dom.logic.off('.dtsb');this.dom.container.trigger('dtsb-destroy').remove();this.s.criteria=[];};Group.prototype.getDetails=function(deFormatDates){if(deFormatDates===void 0){deFormatDates=false;}
if(this.s.criteria.length===0){return{};}
var details={criteria:[],logic:this.s.logic};for(var _i=0,_a=this.s.criteria;_i<_a.length;_i++){var crit=_a[_i];details.criteria.push(crit.criteria.getDetails(deFormatDates));}
return details;};Group.prototype.getNode=function(){return this.dom.container;};Group.prototype.rebuild=function(loadedDetails){if(loadedDetails.criteria===undefined||loadedDetails.criteria===null||Array.isArray(loadedDetails.criteria)&&loadedDetails.criteria.length===0){return;}
this.s.logic=loadedDetails.logic;this.dom.logic.children().first().html(this.s.logic==='OR'?this.s.dt.i18n('searchBuilder.logicOr',this.c.i18n.logicOr):this.s.dt.i18n('searchBuilder.logicAnd',this.c.i18n.logicAnd));if(Array.isArray(loadedDetails.criteria)){for(var _i=0,_a=loadedDetails.criteria;_i<_a.length;_i++){var crit=_a[_i];if(crit.logic!==undefined){this._addPrevGroup(crit);}
else if(crit.logic===undefined){this._addPrevCriteria(crit);}}}
for(var _b=0,_c=this.s.criteria;_b<_c.length;_b++){var crit=_c[_b];if(crit.criteria instanceof Criteria){crit.criteria.updateArrows(this.s.criteria.length>1,false);this._setCriteriaListeners(crit.criteria);}}};Group.prototype.redrawContents=function(){if(this.s.preventRedraw){return;}
this.dom.container.children().detach();this.dom.container.append(this.dom.logicContainer).append(this.dom.add);this.s.criteria.sort(function(a,b){if(a.criteria.s.index<b.criteria.s.index){return-1;}
else if(a.criteria.s.index>b.criteria.s.index){return 1;}
return 0;});this.setListeners();for(var i=0;i<this.s.criteria.length;i++){var crit=this.s.criteria[i].criteria;if(crit instanceof Criteria){this.s.criteria[i].index=i;this.s.criteria[i].criteria.s.index=i;this.s.criteria[i].criteria.dom.container.insertBefore(this.dom.add);this._setCriteriaListeners(crit);this.s.criteria[i].criteria.rebuild(this.s.criteria[i].criteria.getDetails());}
else if(crit instanceof Group&&crit.s.criteria.length>0){this.s.criteria[i].index=i;this.s.criteria[i].criteria.s.index=i;this.s.criteria[i].criteria.dom.container.insertBefore(this.dom.add);crit.redrawContents();this._setGroupListeners(crit);}
else{this.s.criteria.splice(i,1);i--;}}
this.setupLogic();};Group.prototype.redrawLogic=function(){for(var _i=0,_a=this.s.criteria;_i<_a.length;_i++){var crit=_a[_i];if(crit instanceof Group){crit.redrawLogic();}}
this.setupLogic();};Group.prototype.search=function(rowData,rowIdx){if(this.s.logic==='AND'){return this._andSearch(rowData,rowIdx);}
else if(this.s.logic==='OR'){return this._orSearch(rowData,rowIdx);}
return true;};Group.prototype.setupLogic=function(){this.dom.logicContainer.remove();this.dom.clear.remove();if(this.s.criteria.length<1){if(!this.s.isChild){this.dom.container.trigger('dtsb-destroy');this.dom.container.css('margin-left',0);}
return;}
var height=this.dom.container.height()-1;this.dom.clear.height('0px');this.dom.logicContainer.append(this.dom.clear).width(height);this.dom.container.prepend(this.dom.logicContainer);this._setLogicListener();this.dom.container.css('margin-left',this.dom.logicContainer.outerHeight(true));var logicOffset=this.dom.logicContainer.offset();var currentLeft=logicOffset.left;var groupLeft=this.dom.container.offset().left;var shuffleLeft=currentLeft-groupLeft;var newPos=currentLeft-shuffleLeft-this.dom.logicContainer.outerHeight(true);this.dom.logicContainer.offset({left:newPos});var firstCrit=this.dom.logicContainer.next();var currentTop=logicOffset.top;var firstTop=$$1(firstCrit).offset().top;var shuffleTop=currentTop-firstTop;var newTop=currentTop-shuffleTop;this.dom.logicContainer.offset({top:newTop});this.dom.clear.outerHeight(this.dom.logicContainer.height());this._setClearListener();};Group.prototype.setListeners=function(){var _this=this;this.dom.add.unbind('click');this.dom.add.on('click.dtsb',function(){if(!_this.s.isChild){_this.dom.container.prepend(_this.dom.logicContainer);}
_this.addCriteria();_this.dom.container.trigger('dtsb-add');_this.s.dt.state.save();return false;});for(var _i=0,_a=this.s.criteria;_i<_a.length;_i++){var crit=_a[_i];crit.criteria.setListeners();}
this._setClearListener();this._setLogicListener();};Group.prototype.addCriteria=function(crit,redraw){if(crit===void 0){crit=null;}
if(redraw===void 0){redraw=true;}
var index=crit===null?this.s.criteria.length:crit.s.index;var criteria=new Criteria(this.s.dt,this.s.opts,this.s.topGroup,index,this.s.depth);if(crit!==null){criteria.c=crit.c;criteria.s=crit.s;criteria.s.depth=this.s.depth;criteria.classes=crit.classes;}
criteria.populate();var inserted=false;for(var i=0;i<this.s.criteria.length;i++){if(i===0&&this.s.criteria[i].criteria.s.index>criteria.s.index){criteria.getNode().insertBefore(this.s.criteria[i].criteria.dom.container);inserted=true;}
else if(i<this.s.criteria.length-1&&this.s.criteria[i].criteria.s.index<criteria.s.index&&this.s.criteria[i+1].criteria.s.index>criteria.s.index){criteria.getNode().insertAfter(this.s.criteria[i].criteria.dom.container);inserted=true;}}
if(!inserted){criteria.getNode().insertBefore(this.dom.add);}
this.s.criteria.push({criteria:criteria,index:index});this.s.criteria=this.s.criteria.sort(function(a,b){return a.criteria.s.index-b.criteria.s.index;});for(var _i=0,_a=this.s.criteria;_i<_a.length;_i++){var opt=_a[_i];if(opt.criteria instanceof Criteria){opt.criteria.updateArrows(this.s.criteria.length>1,redraw);}}
this._setCriteriaListeners(criteria);criteria.setListeners();this.setupLogic();};Group.prototype.checkFilled=function(){for(var _i=0,_a=this.s.criteria;_i<_a.length;_i++){var crit=_a[_i];if(crit.criteria instanceof Criteria&&crit.criteria.s.filled||crit.criteria instanceof Group&&crit.criteria.checkFilled()){return true;}}
return false;};Group.prototype.count=function(){var count=0;for(var _i=0,_a=this.s.criteria;_i<_a.length;_i++){var crit=_a[_i];if(crit.criteria instanceof Group){count+=crit.criteria.count();}
else{count++;}}
return count;};Group.prototype._addPrevGroup=function(loadedGroup){var idx=this.s.criteria.length;var group=new Group(this.s.dt,this.c,this.s.topGroup,idx,true,this.s.depth+1);this.s.criteria.push({criteria:group,index:idx,logic:group.s.logic});group.rebuild(loadedGroup);this.s.criteria[idx].criteria=group;this.s.topGroup.trigger('dtsb-redrawContents');this._setGroupListeners(group);};Group.prototype._addPrevCriteria=function(loadedCriteria){var idx=this.s.criteria.length;var criteria=new Criteria(this.s.dt,this.s.opts,this.s.topGroup,idx,this.s.depth);criteria.populate();this.s.criteria.push({criteria:criteria,index:idx});criteria.rebuild(loadedCriteria);this.s.criteria[idx].criteria=criteria;this.s.topGroup.trigger('dtsb-redrawContents');};Group.prototype._andSearch=function(rowData,rowIdx){if(this.s.criteria.length===0){return true;}
for(var _i=0,_a=this.s.criteria;_i<_a.length;_i++){var crit=_a[_i];if(crit.criteria instanceof Criteria&&!crit.criteria.s.filled){continue;}
else if(!crit.criteria.search(rowData,rowIdx)){return false;}}
return true;};Group.prototype._orSearch=function(rowData,rowIdx){if(this.s.criteria.length===0){return true;}
var filledfound=false;for(var _i=0,_a=this.s.criteria;_i<_a.length;_i++){var crit=_a[_i];if(crit.criteria instanceof Criteria&&crit.criteria.s.filled){filledfound=true;if(crit.criteria.search(rowData,rowIdx)){return true;}}
else if(crit.criteria instanceof Group&&crit.criteria.checkFilled()){filledfound=true;if(crit.criteria.search(rowData,rowIdx)){return true;}}}
return!filledfound;};Group.prototype._removeCriteria=function(criteria,group){if(group===void 0){group=false;}
if(this.s.criteria.length<=1&&this.s.isChild){this.destroy();}
else{var last=void 0;for(var i=0;i<this.s.criteria.length;i++){if(this.s.criteria[i].index===criteria.s.index&&(!group||this.s.criteria[i].criteria instanceof Group)){last=i;}}
if(last!==undefined){this.s.criteria.splice(last,1);}
for(var i=0;i<this.s.criteria.length;i++){this.s.criteria[i].index=i;this.s.criteria[i].criteria.s.index=i;}}};Group.prototype._setCriteriaListeners=function(criteria){var _this=this;criteria.dom["delete"].unbind('click').on('click.dtsb',function(){_this._removeCriteria(criteria);criteria.dom.container.remove();for(var _i=0,_a=_this.s.criteria;_i<_a.length;_i++){var crit=_a[_i];if(crit.criteria instanceof Criteria){crit.criteria.updateArrows(_this.s.criteria.length>1);}}
criteria.destroy();_this.s.dt.draw();_this.s.topGroup.trigger('dtsb-redrawContents');return false;});criteria.dom.right.unbind('click').on('click.dtsb',function(){var idx=criteria.s.index;var group=new Group(_this.s.dt,_this.s.opts,_this.s.topGroup,criteria.s.index,true,_this.s.depth+1);group.addCriteria(criteria);_this.s.criteria[idx].criteria=group;_this.s.criteria[idx].logic='AND';_this.s.topGroup.trigger('dtsb-redrawContents');_this._setGroupListeners(group);return false;});criteria.dom.left.unbind('click').on('click.dtsb',function(){_this.s.toDrop=new Criteria(_this.s.dt,_this.s.opts,_this.s.topGroup,criteria.s.index);_this.s.toDrop.s=criteria.s;_this.s.toDrop.c=criteria.c;_this.s.toDrop.classes=criteria.classes;_this.s.toDrop.populate();var index=_this.s.toDrop.s.index;_this.dom.container.trigger('dtsb-dropCriteria');criteria.s.index=index;_this._removeCriteria(criteria);_this.s.topGroup.trigger('dtsb-redrawContents');_this.s.dt.draw();return false;});};Group.prototype._setClearListener=function(){var _this=this;this.dom.clear.unbind('click').on('click.dtsb',function(){if(!_this.s.isChild){_this.dom.container.trigger('dtsb-clearContents');return false;}
_this.destroy();_this.s.topGroup.trigger('dtsb-redrawContents');return false;});};Group.prototype._setGroupListeners=function(group){var _this=this;group.dom.add.unbind('click').on('click.dtsb',function(){_this.setupLogic();_this.dom.container.trigger('dtsb-add');return false;});group.dom.container.unbind('dtsb-add').on('dtsb-add.dtsb',function(){_this.setupLogic();_this.dom.container.trigger('dtsb-add');return false;});group.dom.container.unbind('dtsb-destroy').on('dtsb-destroy.dtsb',function(){_this._removeCriteria(group,true);group.dom.container.remove();_this.setupLogic();return false;});group.dom.container.unbind('dtsb-dropCriteria').on('dtsb-dropCriteria.dtsb',function(){var toDrop=group.s.toDrop;toDrop.s.index=group.s.index;toDrop.updateArrows(_this.s.criteria.length>1,false);_this.addCriteria(toDrop,false);return false;});group.setListeners();};Group.prototype._setup=function(){this.setListeners();this.dom.add.html(this.s.dt.i18n('searchBuilder.add',this.c.i18n.add));this.dom.logic.children().first().html(this.c.logic==='OR'?this.s.dt.i18n('searchBuilder.logicOr',this.c.i18n.logicOr):this.s.dt.i18n('searchBuilder.logicAnd',this.c.i18n.logicAnd));this.s.logic=this.c.logic==='OR'?'OR':'AND';if(this.c.greyscale){this.dom.logic.addClass(this.classes.greyscale);}
this.dom.logicContainer.append(this.dom.logic).append(this.dom.clear);if(this.s.isChild){this.dom.container.append(this.dom.logicContainer);}
this.dom.container.append(this.dom.add);};Group.prototype._setLogicListener=function(){var _this=this;this.dom.logic.unbind('click').on('click.dtsb',function(){_this._toggleLogic();_this.s.dt.draw();for(var _i=0,_a=_this.s.criteria;_i<_a.length;_i++){var crit=_a[_i];crit.criteria.setListeners();}});};Group.prototype._toggleLogic=function(){if(this.s.logic==='OR'){this.s.logic='AND';this.dom.logic.children().first().html(this.s.dt.i18n('searchBuilder.logicAnd',this.c.i18n.logicAnd));}
else if(this.s.logic==='AND'){this.s.logic='OR';this.dom.logic.children().first().html(this.s.dt.i18n('searchBuilder.logicOr',this.c.i18n.logicOr));}};Group.version='1.1.0';Group.classes={add:'dtsb-add',button:'dtsb-button',clearGroup:'dtsb-clearGroup',greyscale:'dtsb-greyscale',group:'dtsb-group',inputButton:'dtsb-iptbtn',logic:'dtsb-logic',logicContainer:'dtsb-logicContainer'};Group.defaults={columns:true,conditions:{'date':Criteria.dateConditions,'html':Criteria.stringConditions,'html-num':Criteria.numConditions,'html-num-fmt':Criteria.numFmtConditions,'luxon':Criteria.luxonDateConditions,'moment':Criteria.momentDateConditions,'num':Criteria.numConditions,'num-fmt':Criteria.numFmtConditions,'string':Criteria.stringConditions},depthLimit:false,enterSearch:false,filterChanged:undefined,greyscale:false,i18n:{add:'Add Condition',button:{0:'Search Builder',_:'Search Builder (%d)'},clearAll:'Clear All',condition:'Condition',data:'Data',"delete":'&times',deleteTitle:'Delete filtering rule',left:'<',leftTitle:'Outdent criteria',logicAnd:'And',logicOr:'Or',right:'>',rightTitle:'Indent criteria',title:{0:'Custom Search Builder',_:'Custom Search Builder (%d)'},value:'Value',valueJoiner:'and'},logic:'AND',orthogonal:{display:'display',search:'filter'},preDefined:false};return Group;}());var $;var dataTable;function setJQuery(jq){$=jq;dataTable=jq.fn.DataTable;}
var SearchBuilder=(function(){function SearchBuilder(builderSettings,opts){var _this=this;if(!dataTable||!dataTable.versionCheck||!dataTable.versionCheck('1.10.0')){throw new Error('SearchBuilder requires DataTables 1.10 or newer');}
var table=new dataTable.Api(builderSettings);this.classes=$.extend(true,{},SearchBuilder.classes);this.c=$.extend(true,{},SearchBuilder.defaults,opts);this.dom={clearAll:$('<button type="button">'+table.i18n('searchBuilder.clearAll',this.c.i18n.clearAll)+'</button>').addClass(this.classes.clearAll).addClass(this.classes.button).attr('type','button'),container:$('<div/>').addClass(this.classes.container),title:$('<div/>').addClass(this.classes.title),titleRow:$('<div/>').addClass(this.classes.titleRow),topGroup:undefined};this.s={dt:table,opts:opts,search:undefined,topGroup:undefined};if(table.settings()[0]._searchBuilder!==undefined){return;}
table.settings()[0]._searchBuilder=this;if(this.s.dt.page.info().serverSide){this.s.dt.on('preXhr.dtsb',function(e,settings,data){var loadedState=_this.s.dt.state.loaded();if(loadedState&&loadedState.searchBuilder){data.searchBuilder=_this._collapseArray(loadedState.searchBuilder);}});}
if(this.s.dt.settings()[0]._bInitComplete){this._setUp();}
else{table.one('init.dt',function(){_this._setUp();});}
return this;}
SearchBuilder.prototype.getDetails=function(deFormatDates){if(deFormatDates===void 0){deFormatDates=false;}
return this.s.topGroup.getDetails(deFormatDates);};SearchBuilder.prototype.getNode=function(){return this.dom.container;};SearchBuilder.prototype.rebuild=function(details){this.dom.clearAll.click();if(details===undefined||details===null){return this;}
this.s.topGroup.s.preventRedraw=true;this.s.topGroup.rebuild(details);this.s.topGroup.s.preventRedraw=false;this.s.topGroup.redrawContents();this.s.dt.draw(false);this.s.topGroup.setListeners();return this;};SearchBuilder.prototype._applyPreDefDefaults=function(preDef){var _this=this;if(preDef.criteria!==undefined&&preDef.logic===undefined){preDef.logic='AND';}
var _loop_1=function(crit){if(crit.criteria!==undefined){crit=this_1._applyPreDefDefaults(crit);}
else{this_1.s.dt.columns().every(function(index){if(_this.s.dt.settings()[0].aoColumns[index].sTitle===crit.data){crit.dataIdx=index;}});}};var this_1=this;for(var _i=0,_a=preDef.criteria;_i<_a.length;_i++){var crit=_a[_i];_loop_1(crit);}
return preDef;};SearchBuilder.prototype._setUp=function(loadState){var _this=this;if(loadState===void 0){loadState=true;}
$.fn.DataTable.Api.registerPlural('columns().type()','column().type()',function(){return this.iterator('column',function(settings,column){return settings.aoColumns[column].sType;},1);});if(!dataTable.DateTime){var types=this.s.dt.columns().type().toArray();if(types===undefined||types.includes(undefined)||types.includes(null)){types=[];for(var _i=0,_a=this.s.dt.settings()[0].aoColumns;_i<_a.length;_i++){var colInit=_a[_i];types.push(colInit.searchBuilderType!==undefined?colInit.searchBuilderType:colInit.sType);}}
var columnIdxs=this.s.dt.columns().toArray();if(types===undefined||types.includes(undefined)||types.includes(null)){$.fn.dataTable.ext.oApi._fnColumnTypes(this.s.dt.settings()[0]);types=this.s.dt.columns().type().toArray();}
for(var i=0;i<columnIdxs[0].length;i++){var column=columnIdxs[0][i];var type=types[column];if((this.c.columns===true||Array.isArray(this.c.columns)&&this.c.columns.includes(i))&&(type.includes('date')||type.includes('moment')||type.includes('luxon'))){alert('SearchBuilder Requires DateTime when used with dates.');throw new Error('SearchBuilder requires DateTime');}}}
this.s.topGroup=new Group(this.s.dt,this.c,undefined);this._setClearListener();this.s.dt.on('stateSaveParams.dtsb',function(e,settings,data){data.searchBuilder=_this.getDetails();data.page=_this.s.dt.page();});this.s.dt.on('stateLoadParams.dtsb',function(e,settings,data){_this.rebuild(data.searchBuilder);});this._build();this.s.dt.on('preXhr.dtsb',function(e,settings,data){if(_this.s.dt.page.info().serverSide){data.searchBuilder=_this._collapseArray(_this.getDetails(true));}});this.s.dt.on('column-reorder',function(){_this.rebuild(_this.getDetails());});if(loadState){var loadedState=this.s.dt.state.loaded();if(loadedState!==null&&loadedState.searchBuilder!==undefined){this.s.topGroup.rebuild(loadedState.searchBuilder);this.s.topGroup.dom.container.trigger('dtsb-redrawContents');if(!this.s.dt.page.info().serverSide){this.s.dt.page(loadedState.page).draw('page');}
this.s.topGroup.setListeners();}
else if(this.c.preDefined!==false){this.c.preDefined=this._applyPreDefDefaults(this.c.preDefined);this.rebuild(this.c.preDefined);}}
this._setEmptyListener();this.s.dt.state.save();};SearchBuilder.prototype._collapseArray=function(criteria){if(criteria.logic===undefined){if(criteria.value!==undefined){criteria.value.sort(function(a,b){if(!isNaN(+a)){a=+a;b=+b;}
if(a<b){return-1;}
else if(b<a){return 1;}
else{return 0;}});criteria.value1=criteria.value[0];criteria.value2=criteria.value[1];}}
else{for(var i=0;i<criteria.criteria.length;i++){criteria.criteria[i]=this._collapseArray(criteria.criteria[i]);}}
return criteria;};SearchBuilder.prototype._updateTitle=function(count){this.dom.title.html(this.s.dt.i18n('searchBuilder.title',this.c.i18n.title,count));};SearchBuilder.prototype._build=function(){var _this=this;this.dom.clearAll.remove();this.dom.container.empty();var count=this.s.topGroup.count();this._updateTitle(count);this.dom.titleRow.append(this.dom.title);this.dom.container.append(this.dom.titleRow);this.dom.topGroup=this.s.topGroup.getNode();this.dom.container.append(this.dom.topGroup);this._setRedrawListener();var tableNode=this.s.dt.table(0).node();if(!$.fn.dataTable.ext.search.includes(this.s.search)){this.s.search=function(settings,searchData,dataIndex){if(settings.nTable!==tableNode){return true;}
return _this.s.topGroup.search(searchData,dataIndex);};$.fn.dataTable.ext.search.push(this.s.search);}
this.s.dt.on('destroy.dtsb',function(){_this.dom.container.remove();_this.dom.clearAll.remove();var searchIdx=$.fn.dataTable.ext.search.indexOf(_this.s.search);while(searchIdx!==-1){$.fn.dataTable.ext.search.splice(searchIdx,1);searchIdx=$.fn.dataTable.ext.search.indexOf(_this.s.search);}
_this.s.dt.off('.dtsb');$(_this.s.dt.table().node()).off('.dtsb');});};SearchBuilder.prototype._checkClear=function(){if(this.s.topGroup.s.criteria.length>0){this.dom.clearAll.insertAfter(this.dom.title);this._setClearListener();}
else{this.dom.clearAll.remove();}};SearchBuilder.prototype._filterChanged=function(count){var fn=this.c.filterChanged;if(typeof fn==='function'){fn(count,this.s.dt.i18n('searchBuilder.button',this.c.i18n.button,count));}};SearchBuilder.prototype._setClearListener=function(){var _this=this;this.dom.clearAll.unbind('click');this.dom.clearAll.on('click.dtsb',function(){_this.s.topGroup=new Group(_this.s.dt,_this.c,undefined);_this._build();_this.s.dt.draw();_this.s.topGroup.setListeners();_this.dom.clearAll.remove();_this._setEmptyListener();_this._filterChanged(0);return false;});};SearchBuilder.prototype._setRedrawListener=function(){var _this=this;this.s.topGroup.dom.container.unbind('dtsb-redrawContents');this.s.topGroup.dom.container.on('dtsb-redrawContents.dtsb',function(){_this._checkClear();_this.s.topGroup.redrawContents();_this.s.topGroup.setupLogic();_this._setEmptyListener();var count=_this.s.topGroup.count();_this._updateTitle(count);_this._filterChanged(count);if(!_this.s.dt.page.info().serverSide){_this.s.dt.draw();}
_this.s.dt.state.save();});this.s.topGroup.dom.container.unbind('dtsb-redrawLogic');this.s.topGroup.dom.container.on('dtsb-redrawLogic.dtsb',function(){_this.s.topGroup.redrawLogic();var count=_this.s.topGroup.count();_this._updateTitle(count);_this._filterChanged(count);});this.s.topGroup.dom.container.unbind('dtsb-add');this.s.topGroup.dom.container.on('dtsb-add.dtsb',function(){var count=_this.s.topGroup.count();_this._updateTitle(count);_this._filterChanged(count);});this.s.dt.on('postEdit.dtsb postCreate.dtsb postRemove.dtsb',function(){_this.s.topGroup.redrawContents();});this.s.topGroup.dom.container.unbind('dtsb-clearContents');this.s.topGroup.dom.container.on('dtsb-clearContents.dtsb',function(){_this._setUp(false);_this._filterChanged(0);_this.s.dt.draw();});};SearchBuilder.prototype._setEmptyListener=function(){var _this=this;this.s.topGroup.dom.add.on('click.dtsb',function(){_this._checkClear();});this.s.topGroup.dom.container.on('dtsb-destroy.dtsb',function(){_this.dom.clearAll.remove();});};SearchBuilder.version='1.3.1';SearchBuilder.classes={button:'dtsb-button',clearAll:'dtsb-clearAll',container:'dtsb-searchBuilder',inputButton:'dtsb-iptbtn',title:'dtsb-title',titleRow:'dtsb-titleRow'};SearchBuilder.defaults={columns:true,conditions:{'date':Criteria.dateConditions,'html':Criteria.stringConditions,'html-num':Criteria.numConditions,'html-num-fmt':Criteria.numFmtConditions,'luxon':Criteria.luxonDateConditions,'moment':Criteria.momentDateConditions,'num':Criteria.numConditions,'num-fmt':Criteria.numFmtConditions,'string':Criteria.stringConditions},depthLimit:false,enterSearch:false,filterChanged:undefined,greyscale:false,i18n:{add:'Add Condition',button:{0:'Search Builder',_:'Search Builder (%d)'},clearAll:'Clear All',condition:'Condition',conditions:{array:{contains:'Contains',empty:'Empty',equals:'Equals',not:'Not',notEmpty:'Not Empty',without:'Without'},date:{after:'After',before:'Before',between:'Between',empty:'Empty',equals:'Equals',not:'Not',notBetween:'Not Between',notEmpty:'Not Empty'},number:{between:'Between',empty:'Empty',equals:'Equals',gt:'Greater Than',gte:'Greater Than Equal To',lt:'Less Than',lte:'Less Than Equal To',not:'Not',notBetween:'Not Between',notEmpty:'Not Empty'},string:{contains:'Contains',empty:'Empty',endsWith:'Ends With',equals:'Equals',not:'Not',notContains:'Does Not Contain',notEmpty:'Not Empty',notEndsWith:'Does Not End With',notStartsWith:'Does Not Start With',startsWith:'Starts With'}},data:'Data',"delete":'&times',deleteTitle:'Delete filtering rule',left:'<',leftTitle:'Outdent criteria',logicAnd:'And',logicOr:'Or',right:'>',rightTitle:'Indent criteria',title:{0:'Custom Search Builder',_:'Custom Search Builder (%d)'},value:'Value',valueJoiner:'and'},logic:'AND',orthogonal:{display:'display',search:'filter'},preDefined:false};return SearchBuilder;}());/*! SearchBuilder 1.3.1
     * Â©SpryMedia Ltd - datatables.net/license/mit
     */
(function(factory){if(typeof define==='function'&&define.amd){define(['jquery','datatables.net'],function($){return factory($,window,document);});}
else if(typeof exports==='object'){module.exports=function(root,$){if(!root){root=window;}
if(!$||!$.fn.dataTable){$=require('datatables.net')(root,$).$;}
return factory($,root,root.document);};}
else{factory(window.jQuery,window,document);}}(function($,window,document){setJQuery($);setJQuery$1($);setJQuery$2($);var dataTable=$.fn.dataTable;$.fn.dataTable.SearchBuilder=SearchBuilder;$.fn.DataTable.SearchBuilder=SearchBuilder;$.fn.dataTable.Group=Group;$.fn.DataTable.Group=Group;$.fn.dataTable.Criteria=Criteria;$.fn.DataTable.Criteria=Criteria;var apiRegister=$.fn.dataTable.Api.register;$.fn.dataTable.ext.searchBuilder={conditions:{}};$.fn.dataTable.ext.buttons.searchBuilder={action:function(e,dt,node,config){this.popover(config._searchBuilder.getNode(),{align:'container',span:'container'});if(config._searchBuilder.s.topGroup!==undefined){config._searchBuilder.s.topGroup.dom.container.trigger('dtsb-redrawContents');}
if(config._searchBuilder.s.topGroup.s.criteria.length===0){$('.'+$.fn.dataTable.Group.classes.add).click();}},config:{},init:function(dt,node,config){var sb=new $.fn.dataTable.SearchBuilder(dt,$.extend({filterChanged:function(count,text){dt.button(node).text(text);}},config.config));dt.button(node).text(config.text||dt.i18n('searchBuilder.button',sb.c.i18n.button,0));config._searchBuilder=sb;},text:null};apiRegister('searchBuilder.getDetails()',function(deFormatDates){if(deFormatDates===void 0){deFormatDates=false;}
var ctx=this.context[0];return ctx._searchBuilder?ctx._searchBuilder.getDetails(deFormatDates):null;});apiRegister('searchBuilder.rebuild()',function(details){var ctx=this.context[0];if(ctx._searchBuilder===undefined){return null;}
ctx._searchBuilder.rebuild(details);return this;});apiRegister('searchBuilder.container()',function(){var ctx=this.context[0];return ctx._searchBuilder?ctx._searchBuilder.getNode():null;});function _init(settings,options){var api=new dataTable.Api(settings);var opts=options?options:api.init().searchBuilder||dataTable.defaults.searchBuilder;var searchBuilder=new SearchBuilder(api,opts);var node=searchBuilder.getNode();return node;}
$(document).on('preInit.dt.dtsp',function(e,settings){if(e.namespace!=='dt'){return;}
if(settings.oInit.searchBuilder||dataTable.defaults.searchBuilder){if(!settings._searchBuilder){_init(settings);}}});dataTable.ext.feature.push({cFeature:'Q',fnInit:_init});if(dataTable.ext.features){dataTable.ext.features.register('searchBuilder',_init);}}));}());